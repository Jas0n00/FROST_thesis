@startuml Pedersen DKG
title Pedersen DKG Diagram
participant Aggregator as agg #Yellow
participant Participant_1 as p1
participant Participant_2 as p2

 

!pragma teoz true

agg -> agg : init_pub_commit
& p1 -> p1 : init_pub_commit
& p2 -> p2 : init_pub_commit

note left of agg : broadcast
agg -> p2 : pub_commit_packet
& p2 -> agg 

agg -> p1 : pub_commit_packet
& p1 -> agg 
& p1 -> p2 : pub_commit_packet
& p2 -> p1
note left of agg : end of \nbroadcast

agg -> agg : init_sec_share
& p1 -> p1 : init_sec_share
& p2 -> p2 : init_sec_share

agg -> p1 : sec_share (f0(1))
& p1 -> p1 : verify share

agg -> p2 : sec_share (f0(2))
& p2 -> p2 : verify share

p1 --> agg : sec_share (f1(0))
& agg <- agg : verify share

& p1 -> p2 : sec_share (f1(2))
& p2 -> p2 : verify share

p2 --> agg : sec_share (f2(0))
& agg <- agg : verify share

p2 --> p1 : sec_share (f2(1))
& p1 <- p1 : verify share


agg -> agg : gen_keys
& p1 -> p1 : gen_keys
& p2 -> p2 : gen_keys

@enduml
